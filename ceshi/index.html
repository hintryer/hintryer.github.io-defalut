<html><head>
  <meta charset="UTF-8">
  <title>Monaco Editor with Code Actions</title>
  <style>
    #editor-container {
      flex: 1;
    }

    #editor{
      display: flex;
      flex-direction: column;
      height: 200px;
    }
  </style></head>
<body>
  <div id="container">
    <div id="url-input">
      <label for="url">URL:</label>
      <input type="text" id="url">
    </div>
    <div id="editor"></div>
    <div id="buttons">
      <button id="copy-button">复制代码</button>
      <button id="upload-button">上传代码</button>
      <button id="download-button">下载代码</button>
      <button id="format-button">格式化代码</button>
    </div>
  </div>

  <script src="https://unpkg.com/monaco-editor/min/vs/loader.js"></script>
  <script>
    require.config({ paths: { 'vs': 'https://unpkg.com/monaco-editor/min/vs' }});
    require(['vs/editor/editor.main'], function() {
      // 创建 Monaco 编辑器
      const editor = monaco.editor.create(document.getElementById('editor'), {
        value: '//dfwflsf',
        language: 'javascript',
        theme: 'vs-dark'
      });

      // 一键复制代码
      document.getElementById("copy-button").onclick = function() {
        const code = editor.getValue();
        navigator.clipboard.writeText(code);
        alert('已复制到剪贴板');
      };

      // 一键上传代码
      document.getElementById("upload-button").onclick = function() {
        const code = editor.getValue();

        const xhr = new XMLHttpRequest();
        xhr.open("POST", "upload.php");
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.send(JSON.stringify({ code: code }));
      };

      // 一键下载代码
      document.getElementById("download-button").onclick = function() {
       const textareaContent = extractTextarea.value;
    const blob = new Blob([textareaContent], { type: 'text/plain' });
    const urlCreator = window.URL || window.webkitURL;
    const downloadUrl = urlCreator.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = downloadUrl;
    a.download = 'output.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
      };

      // 格式化代码
      document.getElementById("format-button").onclick = function() {
        
  const editor = editor.getModels()[0];
  const model = editor.getModel();

  const formattedCode = monaco.editor.action.format.format(model, {
    tabSize: 2,
    insertSpaces: true,
    wrapLineLength: 120
  });

  model.setValue(formattedCode);
};

      // 从 URL 加载代码
      document.getElementById("url").addEventListener("input", function() {
        const url = this.value;
        if (url.length > 0) {
          const xhr = new XMLHttpRequest();
          xhr.open("GET", url);
          xhr.responseType = "text";
          xhr.onload = function() {
            if (xhr.status === 200) {
              editor.setValue(xhr.response);
            }
          };
          xhr.send();
        }
      });
    });
  </script>

</body></html>
